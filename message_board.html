<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ç•™è¨€å°å¤©åœ°</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: "Microsoft JhengHei", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      margin: 0;
      padding: 0;
      background: #f4f4f4;
    }

    .container {
      max-width: 700px;
      margin: 40px auto;
      background: #ffffff;
      padding: 24px 28px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 18px rgba(0,0,0,0.08);
    }

    h1 {
      margin-top: 0;
      text-align: center;
      color: #333;
      letter-spacing: 1px;
    }

    form {
      margin-bottom: 24px;
    }

    label {
      display: block;
      margin-bottom: 6px;
      font-size: 14px;
      color: #555;
    }

    input[type="text"],
    textarea {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 14px;
      outline: none;
      transition: border 0.15s ease, box-shadow 0.15s ease;
      resize: vertical;
    }

    input[type="text"]:focus,
    textarea:focus {
      border-color: #4a90e2;
      box-shadow: 0 0 0 2px rgba(74,144,226,0.18);
    }

    textarea {
      min-height: 80px;
      max-height: 260px;
    }

    .btn-submit {
      margin-top: 10px;
      padding: 10px 18px;
      border-radius: 999px;
      border: none;
      font-size: 14px;
      cursor: pointer;
      background: #4a90e2;
      color: #fff;
      font-weight: 600;
      letter-spacing: 1px;
      transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.15s ease;
    }

    .btn-submit:hover {
      background: #3b78c0;
      box-shadow: 0 3px 10px rgba(0,0,0,0.15);
      transform: translateY(-1px);
    }

    .btn-submit:active {
      transform: translateY(0);
      box-shadow: none;
    }

    .message-list-title {
      font-size: 16px;
      margin: 10px 0 6px;
      color: #444;
    }

    .empty-tip {
      font-size: 14px;
      color: #999;
      text-align: center;
      margin-top: 8px;
    }

    ul#messageList {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .message-item {
      padding: 10px 12px;
      border-radius: 10px;
      background: #f8f9fb;
      margin-bottom: 10px;
      border: 1px solid #e3e5ea;
    }

    .message-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }

    .message-name {
      font-weight: 600;
      color: #333;
      font-size: 14px;
    }

    .message-time {
      font-size: 12px;
      color: #999;
    }

    .message-text {
      font-size: 14px;
      color: #444;
      white-space: pre-wrap; /* ä¿ç•™æ›è¡Œ */
      word-break: break-word;
      margin-top: 2px;
    }

    .message-actions {
      margin-top: 6px;
      text-align: right;
    }

    .btn-delete {
      border: none;
      background: none;
      color: #cc4b4b;
      font-size: 12px;
      cursor: pointer;
      padding: 2px 4px;
    }

    .btn-delete:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“ ç•™è¨€å°å¤©åœ°</h1>

    <!-- ç•™è¨€è¡¨å–® -->
    <form id="messageForm">
      <label for="nameInput">æš±ç¨±ï¼ˆé¸å¡«ï¼‰</label>
      <input
        type="text"
        id="nameInput"
        placeholder="ä¾‹å¦‚ï¼šå°æ˜ã€è¨ªå®¢â€¦"
      />

      <label for="messageInput">ç•™è¨€å…§å®¹</label>
      <textarea
        id="messageInput"
        placeholder="æƒ³èªªä»€éº¼å‘¢ï¼Ÿ"
        required
      ></textarea>

      <button type="submit" class="btn-submit">é€å‡ºç•™è¨€</button>
    </form>

    <div class="message-list-title">ç•™è¨€åˆ—è¡¨</div>
    <div id="emptyTip" class="empty-tip">ç›®å‰é‚„æ²’æœ‰ç•™è¨€ï¼Œä¾†ç•¶ç¬¬ä¸€å€‹ç•™è¨€çš„äººå§ï¼</div>
    <ul id="messageList"></ul>
  </div>

  <script>
    // ====== ç•™è¨€å°å¤©åœ°ç¨‹å¼ ======

    // å–å¾—ç¶²é ä¸Šçš„å…ƒç´ 
    const messageForm = document.getElementById("messageForm");
    const nameInput = document.getElementById("nameInput");
    const messageInput = document.getElementById("messageInput");
    const messageList = document.getElementById("messageList");
    const emptyTip = document.getElementById("emptyTip");

    // localStorage ä½¿ç”¨çš„ key
    const STORAGE_KEY = "simpleMessageBoardMessages";

    // å…¨éƒ¨ç•™è¨€è³‡æ–™æœƒæš«å­˜åœ¨é€™å€‹é™£åˆ—
    let messages = [];

    // å¾ localStorage è¼‰å…¥è³‡æ–™
    function loadMessages() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        try {
          messages = JSON.parse(saved);
        } catch (e) {
          messages = [];
        }
      } else {
        messages = [];
      }
      renderMessages();
    }

    // æŠŠç›®å‰ messages é™£åˆ—å­˜å› localStorage
    function saveMessages() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(messages));
    }

    // æŠŠæ™‚é–“è½‰æˆå¥½è®€çš„å­—ä¸²
    function formatTime(timestamp) {
      const date = new Date(timestamp);
      const y = date.getFullYear();
      const m = String(date.getMonth() + 1).padStart(2, "0");
      const d = String(date.getDate()).padStart(2, "0");
      const h = String(date.getHours()).padStart(2, "0");
      const min = String(date.getMinutes()).padStart(2, "0");
      return `${y}/${m}/${d} ${h}:${min}`;
    }

    // å°‡ messages é™£åˆ—ç•«åˆ°ç•«é¢ä¸Š
    function renderMessages() {
      // æ¸…ç©ºåŸæœ¬çš„åˆ—è¡¨
      messageList.innerHTML = "";

      if (messages.length === 0) {
        emptyTip.style.display = "block";
        return;
      } else {
        emptyTip.style.display = "none";
      }

      // æœ€æ–°ç•™è¨€æ’åœ¨æœ€ä¸Šé¢
      const sorted = [...messages].sort((a, b) => b.time - a.time);

      sorted.forEach((msg) => {
        const li = document.createElement("li");
        li.className = "message-item";

        // æ¨™é¡Œåˆ—ï¼šæš±ç¨± + æ™‚é–“
        const header = document.createElement("div");
        header.className = "message-header";

        const nameSpan = document.createElement("span");
        nameSpan.className = "message-name";
        nameSpan.textContent = msg.name || "åŒ¿å";

        const timeSpan = document.createElement("span");
        timeSpan.className = "message-time";
        timeSpan.textContent = formatTime(msg.time);

        header.appendChild(nameSpan);
        header.appendChild(timeSpan);

        // å…§å®¹
        const textP = document.createElement("div");
        textP.className = "message-text";
        textP.textContent = msg.text;

        // åˆªé™¤æŒ‰éˆ•
        const actions = document.createElement("div");
        actions.className = "message-actions";

        const deleteBtn = document.createElement("button");
        deleteBtn.className = "btn-delete";
        deleteBtn.textContent = "åˆªé™¤";
        deleteBtn.addEventListener("click", () => handleDelete(msg.id));

        actions.appendChild(deleteBtn);

        li.appendChild(header);
        li.appendChild(textP);
        li.appendChild(actions);

        messageList.appendChild(li);
      });
    }

    // è™•ç†åˆªé™¤ç•™è¨€
    function handleDelete(id) {
      if (!confirm("ç¢ºå®šè¦åˆªé™¤é€™å‰‡ç•™è¨€å—ï¼Ÿ")) return;
      messages = messages.filter((m) => m.id !== id);
      saveMessages();
      renderMessages();
    }

    // è¡¨å–®é€å‡ºäº‹ä»¶ï¼šæ–°å¢ç•™è¨€
    messageForm.addEventListener("submit", function (event) {
      event.preventDefault(); // é˜»æ­¢è¡¨å–®é è¨­åˆ·æ–°é é¢

      const name = nameInput.value.trim();
      const text = messageInput.value.trim();

      if (!text) {
        alert("è«‹å…ˆè¼¸å…¥ç•™è¨€å…§å®¹å“¦ï¼");
        return;
      }

      const newMessage = {
        id: Date.now(),   // ç°¡å–®ç”¨æ™‚é–“æˆ³ç•¶ä½œ id
        name: name,
        text: text,
        time: Date.now()
      };

      messages.push(newMessage);
      saveMessages();
      renderMessages();

      // æ¸…ç©ºè¼¸å…¥æ¬„ä½
      messageInput.value = "";
      // è‹¥æƒ³æ¯æ¬¡ä¹Ÿæ¸…ç©ºæš±ç¨±ï¼Œå¯å¦å¤–åŠ ä¸Šï¼š
      // nameInput.value = "";
    });

    // é é¢è¼‰å…¥æ™‚è®€å–èˆŠç•™è¨€
    loadMessages();
  </script>
</body>
</html>
